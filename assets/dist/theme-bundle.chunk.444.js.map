{"version":3,"file":"theme-bundle.chunk.444.js","mappings":"iIAAe,SAAS,EAACA,GACrB,MAAoB,iBAATA,CAMf,C,kECmBA,QA1Bc,CACVC,MAAK,SAACC,GAEF,MADW,aACDC,KAAKD,EACnB,EAOAE,SAAQ,SAACF,GACL,OAAOG,KAAKC,SAASJ,EACzB,EAQAI,SAAQ,SAACJ,GACL,OAAOA,EAAMK,OAAS,CAC1B,E,6SClB0C,IAEzBC,EAAe,SAAAC,G,QAChC,SAAAD,EAAYE,GAAS,IAAAC,EACjBA,EAAAF,EAAAG,KAAA,KAAMF,IAAQ,KAEd,IAAMG,EAAmBC,EAAE,6BAgCrBC,EAAgBD,EAAE,0BAClBE,EAAiBD,EAAcE,KAAK,oCACpCC,GAAoBC,EAAAA,EAAAA,GAAI,CAC1BC,OAAQ,8CACRC,MAAO,MAGX,GAAIL,EAAeT,OAAQ,CACvB,IAAMe,EAAWP,EAAcE,KAAK,oCAC9BM,EAAMD,EAASE,KAAK,OACpBC,EAAeH,EAASE,KAAK,gBAC7BE,EAAMJ,EAASE,KAAK,OACpBG,EAAeL,EAASE,KAAK,gBAEnCN,EAAkBU,IAAI,CAClBC,SAAU,0DACVC,SAAU,SAACC,EAAIC,GACX,IAAMC,EAAYC,OAAOF,GAEpBC,GACDF,GAAG,GAGPA,EAAGE,GAAaV,GAAOU,GAAaP,EACxC,EACAS,aAAc,+CAA+CV,EAAY,QAAQE,EAAY,KAErG,CAqEA,GAnEAT,EAAkBU,IAAI,CAClB,CACIC,SAAU,+CACVC,SAAU,SAACC,EAAIC,GAGXD,EAhEK,SAACC,GACV,OAAOA,EAAIzB,MACf,CA4DuB6B,CAA4BJ,GAG/C,EACAG,aAAcxB,EAAKD,QAAQ2B,QAE/B,CACIR,SAAU,gDACVC,SAAU,SAACC,EAAIC,GAGXD,EAtEM,WACV,OAAOO,EAAAA,EAAUrC,MAAKsC,MAAfD,EAAAA,EAASE,UACpB,CAkEuBJ,CAA6BJ,GAGhD,EACAG,aAAcxB,EAAKD,QAAQ+B,SAE/B,CACIZ,SAAU,iDACVC,SAAU,SAACC,EAAIC,GAGXD,EA5EE,SAACC,GACP,OAAOA,EAAIzB,MACf,CAwEuB6B,CAAyBJ,GAG5C,EACAG,aAAcxB,EAAKD,QAAQgC,UAE/B,CACIb,SAAU,kDACVC,SAAU,SAACC,EAAIC,GAGXD,EAlFG,WACP,OAAOO,EAAAA,EAAUrC,MAAKsC,MAAfD,EAAAA,EAASE,UACpB,CA8EuBJ,CAA0BJ,GAG7C,EACAG,aAAcxB,EAAKD,QAAQiC,WAE/B,CACId,SAAU,uEACVe,YAAa,yDACbd,SAAU,SAACC,GAGPA,EAAoB,iBAFRhB,EAAcE,KAAK,2CAA2Ce,MAG9E,EACAG,aAAcxB,EAAKD,QAAQmC,WAE/B,CACIhB,SAAU,6CACVC,SAAU,SAACC,GAGPA,EAFYhB,EAAcE,KAAK,uBAAuB6B,IAAI,GAAGC,QAGjE,EACAZ,aAAcxB,EAAKD,QAAQsC,cAE/B,CACInB,SAAU,8CACVC,SAAU,SAACC,GAGPA,EAFYhB,EAAcE,KAAK,wBAAwB6B,IAAI,GAAGC,QAGlE,EACAZ,aAAcxB,EAAKD,QAAQsC,gBAI/BnC,EAAiBN,OAAQ,CACzB,IAAM0C,EAAatC,EAAKuC,0BAA0BrC,GAElDA,EAAiBsC,GAAG,UAAU,WAG1B,GAFAF,EAAWG,gBAENH,EAAWI,OAAO,SACnB,OAAO,CAEf,GACJ,CA+BG,OA7BHtC,EAAcoC,GAAG,UAAU,SAAAG,GAGvB,GAFApC,EAAkBkC,gBAEblC,EAAkBmC,OAAO,SAC1B,OAAOC,EAAMC,gBAErB,IAEAzC,EAAE,6BAA6B0C,OAAM,SAAAF,GAKjC,GAJAA,EAAMC,iBAENrC,EAAkBkC,eAEblC,EAAkBmC,OAAO,SAA9B,CAIA,IAAMI,GAAQC,EAAAA,EAAAA,MACRC,EAAgB7C,EAAEwC,EAAMM,eAAepC,KAAK,cAAa,IAAIT,EAAc8C,YAEjFJ,EAAMK,OAENC,EAAAA,GAAIC,QAAQL,EAAY,CAAC,GAAG,SAACM,EAAKC,GAC9B,GAAID,EACA,OAAOR,EAAMU,cAAcxD,EAAKD,QAAQ0D,cAG5CX,EAAMU,cAAcD,EAAS,CAAEG,MAAM,GACzC,GAbA,CAcJ,IAAG1D,CACP,CAgBC,O,EA9L+BF,G,EAAAD,G,sEA8K/BA,EAAA8D,UAEDpB,0BAAA,SAA0BqB,GACtB,IAAMC,GAAmBrD,EAAAA,EAAAA,GAAI,CACzBC,OAAQmD,EAAatD,KAAK,0BAW9B,OARAuD,EAAiB5C,IAAI,CACjBC,SAAU0C,EAAatD,KAAK,qCAC5Ba,SAAQ,SAACC,EAAIC,GACTD,GAAG0C,EAAAA,EAAAA,GAAgBzC,GACvB,EACAG,aAAc,uCAGXqC,CACX,EAAChE,CAAA,CA9L+B,CAASkE,EAAAA,E","sources":["webpack://bigcommerce-cornerstone/./assets/js/theme/common/gift-certificate-validator.js","webpack://bigcommerce-cornerstone/./assets/js/theme/common/models/forms.js","webpack://bigcommerce-cornerstone/./assets/js/theme/gift-certificate.js"],"sourcesContent":["export default function (cert) {\n    if (typeof cert !== 'string') {\n        return false;\n    }\n\n    // Add any custom gift certificate validation logic here\n    return true;\n}\n","const forms = {\n    email(value) {\n        const re = /^.+@.+\\..+/;\n        return re.test(value);\n    },\n\n    /**\n     * Validates a password field\n     * @param value\n     * @returns {boolean}\n     */\n    password(value) {\n        return this.notEmpty(value);\n    },\n\n    /**\n     * validates if a field is empty\n     * @param value\n     * @returns {boolean}\n     *\n     */\n    notEmpty(value) {\n        return value.length > 0;\n    },\n};\n\nexport default forms;\n","import PageManager from './page-manager';\nimport nod from './common/nod';\nimport giftCertChecker from './common/gift-certificate-validator';\nimport formModel from './common/models/forms';\nimport { api } from '@bigcommerce/stencil-utils';\nimport { defaultModal } from './global/modal';\n\nexport default class GiftCertificate extends PageManager {\n    constructor(context) {\n        super(context);\n\n        const $certBalanceForm = $('#gift-certificate-balance');\n\n        const purchaseModel = {\n            recipientName(val) {\n                return val.length;\n            },\n            recipientEmail(...args) {\n                return formModel.email(...args);\n            },\n            senderName(val) {\n                return val.length;\n            },\n            senderEmail(...args) {\n                return formModel.email(...args);\n            },\n            customAmount(value, min, max) {\n                return value && value >= min && value <= max;\n            },\n            setAmount(value, options) {\n                let found = false;\n\n                options.forEach((option) => {\n                    if (option === value) {\n                        found = true;\n                        return false;\n                    }\n                });\n\n                return found;\n            },\n        };\n\n        const $purchaseForm = $('#gift-certificate-form');\n        const $customAmounts = $purchaseForm.find('input[name=\"certificate_amount\"]');\n        const purchaseValidator = nod({\n            submit: '#gift-certificate-form input[type=\"submit\"]',\n            delay: 300,\n        });\n\n        if ($customAmounts.length) {\n            const $element = $purchaseForm.find('input[name=\"certificate_amount\"]');\n            const min = $element.data('min');\n            const minFormatted = $element.data('minFormatted');\n            const max = $element.data('max');\n            const maxFormatted = $element.data('maxFormatted');\n\n            purchaseValidator.add({\n                selector: '#gift-certificate-form input[name=\"certificate_amount\"]',\n                validate: (cb, val) => {\n                    const numberVal = Number(val);\n\n                    if (!numberVal) {\n                        cb(false);\n                    }\n\n                    cb(numberVal >= min && numberVal <= max);\n                },\n                errorMessage: `You must enter a certificate amount between ${minFormatted} and ${maxFormatted}.`,\n            });\n        }\n\n        purchaseValidator.add([\n            {\n                selector: '#gift-certificate-form input[name=\"to_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"to_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"certificate_theme\"]:first-of-type',\n                triggeredBy: '#gift-certificate-form input[name=\"certificate_theme\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"certificate_theme\"]:checked').val();\n\n                    cb(typeof (val) === 'string');\n                },\n                errorMessage: this.context.certTheme,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree2\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree2\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n        ]);\n\n        if ($certBalanceForm.length) {\n            const balanceVal = this.checkCertBalanceValidator($certBalanceForm);\n\n            $certBalanceForm.on('submit', () => {\n                balanceVal.performCheck();\n\n                if (!balanceVal.areAll('valid')) {\n                    return false;\n                }\n            });\n        }\n\n        $purchaseForm.on('submit', event => {\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return event.preventDefault();\n            }\n        });\n\n        $('#gift-certificate-preview').click(event => {\n            event.preventDefault();\n\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return;\n            }\n\n            const modal = defaultModal();\n            const previewUrl = `${$(event.currentTarget).data('previewUrl')}&${$purchaseForm.serialize()}`;\n\n            modal.open();\n\n            api.getPage(previewUrl, {}, (err, content) => {\n                if (err) {\n                    return modal.updateContent(this.context.previewError);\n                }\n\n                modal.updateContent(content, { wrap: true });\n            });\n        });\n    }\n\n    checkCertBalanceValidator($balanceForm) {\n        const balanceValidator = nod({\n            submit: $balanceForm.find('input[type=\"submit\"]'),\n        });\n\n        balanceValidator.add({\n            selector: $balanceForm.find('input[name=\"giftcertificatecode\"]'),\n            validate(cb, val) {\n                cb(giftCertChecker(val));\n            },\n            errorMessage: 'You must enter a certificate code.',\n        });\n\n        return balanceValidator;\n    }\n}\n"],"names":["cert","email","value","test","password","this","notEmpty","length","GiftCertificate","_PageManager","context","_this","call","$certBalanceForm","$","$purchaseForm","$customAmounts","find","purchaseValidator","nod","submit","delay","$element","min","data","minFormatted","max","maxFormatted","add","selector","validate","cb","val","numberVal","Number","errorMessage","purchaseModel","toName","formModel","apply","arguments","toEmail","fromName","fromEmail","triggeredBy","certTheme","get","checked","agreeToTerms","balanceVal","checkCertBalanceValidator","on","performCheck","areAll","event","preventDefault","click","modal","defaultModal","previewUrl","currentTarget","serialize","open","api","getPage","err","content","updateContent","previewError","wrap","prototype","$balanceForm","balanceValidator","giftCertChecker","PageManager"],"sourceRoot":""}